!function(){var t=angular.module("nzDatepicker",[]);t.directive("nzDatepicker",["$compile","$timeout",function(t,e){var n="CUSTOM",a=['<div ng-show="visible" class="nz-datepicker-wrap {{pickerClass}}" ng-click="handlePickerClick($event)" ng-class="{\'nz-datepicker-ranged\': showRanged}">','   <div class="nz-datepicker-picker">','       <div class="nz-datepicker-timesheet">','           <a ng-click="move(-1, $event)" class="nz-datepicker-prev-month">&#9664;</a>','           <div ng-repeat="month in months" class="nz-datepicker-month">','               <div class="nz-datepicker-month-name">{{month.name}}</div>','               <table class="nz-datepicker-calendar">',"                   <tr>",'                       <th ng-repeat="day in month.weeks[1]" class="nz-datepicker-calendar-weekday">{{day.date.format(\'dd\')}}</th>',"                   </tr>",'                   <tr ng-repeat="week in month.weeks">',"                       <td ng-class=\"{'nz-datepicker-calendar-day': day,'nz-datepicker-calendar-day-selected': day.selected,'nz-datepicker-calendar-day-disabled': day.disabled,'nz-datepicker-calendar-day-start': day.start}\" ng-repeat=\"day in week track by $index\" ng-click=\"select(day, $event)\">",'                           <div class="nz-datepicker-calendar-day-wrapper">{{day.date.date()}}</div>',"                       </td>","                   </tr>","               </table>","           </div>",'           <a ng-click="move(+1, $event)" class="nz-datepicker-next-month">&#9654;</a>',"       </div>",'       <div class="nz-datepicker-panel">','          <span ng-show="showRanged">','              <select ng-click="prevent_select($event)" ng-model="quick" ng-options="e.range as e.label for e in quickList">',"              </select>","          </span>",'           <span class="nz-datepicker-buttons"><a ng-click="ok($event)" class="nz-datepicker-apply">Apply</a><a ng-click="hide($event)" class="nz-datepicker-cancel">cancel</a></span>',"       </div>","   </div>","</div>"].join("");return{restrict:"AE",replace:!1,scope:{model:"=ngModel",pickerClass:"@pickerClass",options:"=?",ranged:"=",pastDates:"@",callback:"&"},link:function(o,r){function s(){return[{label:"Last 7 Days",range:moment().range(moment().startOf("day").subtract(1,"week"),moment().startOf("day"))},{label:"Last 2 Weeks",range:moment().range(moment().startOf("day").subtract(2,"week"),moment().startOf("day"))},{label:"Last Month",range:moment().range(moment().startOf("day").subtract(1,"month"),moment().startOf("day"))},{label:"Last 3 Months",range:moment().range(moment().startOf("day").subtract(3,"month"),moment().startOf("day"))},{label:"Last 6 Months",range:moment().range(moment().startOf("day").subtract(6,"month"),moment().startOf("day"))},{label:"Last Year",range:moment().range(moment().startOf("day").subtract(1,"year"),moment().startOf("day"))}]}function i(){return angular.element(document).bind("click",g),o.selection=o.model,k(),y(),o.visible=!0}function d(t){return angular.element(document).unbind("click",g),null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),o.visible=!1,o.start=null}function c(t){return null!=t&&"function"==typeof t.stopPropagation?t.stopPropagation():void 0}function l(t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),o.model=o.selection,e(function(){return o.callback?o.callback():void 0}),o.hide()}function m(t,e){return null!=e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),t.disabled?void 0:(o.showRanged?(o.selecting=!o.selecting,o.selecting?o.start=t.date:(o.selection=o.start.diff(t.date,"days")>0?moment().range(t.date,o.start):moment().range(o.start,t.date),o.start=null)):o.selection=moment(t.date),y())}function u(t,e){return null!=e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),o.showRanged?o.range=moment().range(o.range.start.add(t,"months").startOf("month").startOf("day"),o.range.start.clone().add(2,"months").endOf("month").startOf("day")):(o.date.add(t,"months"),o.range=moment().range(moment(o.date).startOf("month"),moment(o.date).endOf("month"))),y()}function p(t){return null!=t&&"function"==typeof t.stopPropagation?t.stopPropagation():void 0}function g(){return o.$apply(function(){return o.hide()}),!0}function f(t){var e,a,r,s,i;if(null==t&&(t=!1),o.showRanged){for(o.quickList=[],t&&o.quickList.push({label:"Custom",range:n}),s=o.options,i=[],a=0,r=s.length;r>a;a++)e=s[a],i.push(o.quickList.push(e));return i}}function k(){var t,e;return o.showRanged?o.range=o.selection?(e=o.selection.start.clone().startOf("month").startOf("day"),t=e.clone().add(2,"months").endOf("month").startOf("day"),moment().range(e,t)):moment().range(moment().startOf("month").subtract(1,"month").startOf("day"),moment().endOf("month").add(1,"month").startOf("day")):(o.selection=!1,o.selection=o.model||!1,o.date=moment(o.model)||moment(),o.range=moment().range(moment(o.date).startOf("month"),moment(o.date).endOf("month")))}function h(){var t,e,a,r;if(o.showRanged&&o.selection){for(r=o.quickList,e=0,a=r.length;a>e;e++)if(t=r[e],t.range!==n&&o.selection.start.startOf("day").unix()===t.range.start.startOf("day").unix()&&o.selection.end.startOf("day").unix()===t.range.end.startOf("day").unix())return o.quick=t.range,void f();return o.quick=n,f(!0)}}function y(){var t,e,n,a,r,s;for(o.months=[],s=12*o.range.start.year()+o.range.start.month(),r=moment().startOf("week").day(),o.range.by("days",function(t){var e,n,a,i,d,c,l;return a=t.day()-r,0>a&&(a=7+a),d=12*t.year()+t.month()-s,l=parseInt((7+t.date()-a)/7),c=!1,i=!1,o.showRanged?o.start?(c=t===o.start,i=t<o.start):c=o.selection&&o.selection.contains(t):(c=t.isSame(o.selection),o.pastDates&&(i=moment().diff(t,"days")>0)),(e=o.months)[d]||(e[d]={name:t.format("MMMM YYYY"),weeks:[]}),(n=o.months[d].weeks)[l]||(n[l]=[]),o.months[d].weeks[l][a]={date:t,selected:c,disabled:!1,start:o.start&&o.start.unix()===t.unix()}}),a=o.months,t=0,e=a.length;e>t;t++)n=a[t],n.weeks[0]||n.weeks.splice(0,1);return h()}var v=t(angular.element(a))(o);return angular.element(document.body).append(v),o.quick=null,o.range=null,o.selecting=!1,o.visible=!1,o.start=null,o.showRanged=void 0===o.ranged?!0:o.ranged,o.options&&o.options.length||(o.options=s()),o.show=i,o.hide=d,o.prevent_select=c,o.ok=l,o.select=m,o.move=u,o.handlePickerClick=p,r.bind("click",function(t){return null!=t&&"function"==typeof t.stopPropagation&&t.stopPropagation(),o.$apply(function(){return o.visible?o.hide():o.show()})}),o.$watch("quick",function(t){return t&&t!==n?(o.selection=o.quick,o.selecting=!1,o.start=null,k(),y()):void 0}),o.$watch("options",function(t){return"undefined"!=typeof options&&null!==options?o.options=t:void 0}),o.$on("$destroy",function(){return v.remove(),angular.element(document).unbind("click",g)}),f(),k(),y()}}}])}();